Katostaan hakemuksilta mitä pisteitä puuttuu:


db.application.find({applicationSystemId:"1.2.246.562.29.10108985853"}).forEach(function(h){
	if(h.additionalInfo){
		Object.keys(h.additionalInfo).forEach(function(key){
			if(h.additionalInfo[key] === "MERKITSEMATTA"){
				print(key + " " + h.oid)
			}
		})
	}
})


---

Koosta edellisestä vastauksesta valintakoetunnisteet ja oidit erilleen.
Riivitään valintalaskentakoostemongosta soveltuvuuskokeiden järjestäjien hakukohteet:

var valintakoetunnistees=[
'Kauneudenhoitoalan perustutkinto, pk, pääsy- ja soveltuvuuskoe',
'Lapsi- ja perhetyön perustutkinto, pk, pääsy- ja soveltuvuuskoe',
'Logistiikan perustutkinto, pk, pääsy- ja soveltuvuuskoe',
'Nuoriso- ja vapaa-ajan ohjauksen perustutkinto, pk, pääsy- ja soveltuvuuskoe',
'Sosiaali- ja terveysalan perustutkinto, pk, pääsy- ja soveltuvuuskoe',
'Sosiaali- ja terveysalan perustutkinto, yo, pääsy- ja soveltuvuuskoe',
'Turvallisuusalan perustutkinto, pk, pääsy- ja soveltuvuuskoe'
]
var oids = [
'1.2.246.562.11.00008098771'
]
db.ValintakoeOsallistuminen.find({"hakutoiveet.valinnanVaiheet.valintakokeet.valintakoeTunniste":{$in:valintakoetunnistees},
  								 "hakutoiveet.valinnanVaiheet.valintakokeet.osallistuminenTulos.osallistuminen": "OSALLISTUU",
  								 "hakemusOid":{$in:oids}}).forEach(function(h){
  								 h.hakutoiveet.forEach(function(ht){
  								  ht.valinnanVaiheet.forEach(function(vv){
  								    vv.valintakokeet.forEach(function(vk){
  								      if(valintakoetunnistees.indexOf(vk.valintakoeTunniste) > -1 && vk.osallistuminenTulos.osallistuminen === "OSALLISTUU"){
  								        print(h.hakemusOid + " " + vk.valintakoeTunniste + " " + vk.osallistuminenTulos.osallistuminen + " " + ht.hakukohdeOid)
  								      }
  								    })
  								  })
  								 })
  								 })


---


Haetaan tarjonnan kannasta hakukohteiden tarjoajat

select distinct k.tarjoaja, h.oid
from hakukohde h
  join koulutus_hakukohde kh on kh.hakukohde_id = h.id
  join koulutusmoduuli_toteutus k on kh.koulutus_id = k.id
where h.oid in (
  '1.2.246.562.20.60967919402'
);

---

Katso seuraavaksi 4Tarjoajien haku